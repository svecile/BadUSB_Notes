# BadUSB
My presentation will be on [CVE-2011-0638](https://nvd.nist.gov/vuln/detail/CVE-2011-0638), [CVE-2011-0639](https://nvd.nist.gov/vuln/detail/CVE-2011-0639) and [CVE-2011-0640](https://nvd.nist.gov/vuln/detail/CVE-2011-0640) which are all the same voulnerability but one is for windows, one is for Mac OS X and one is for Linux. This voulnerability is quite simple, when you connect a usb human interface device (HID) to a computer such as a keyboard/mouse your computer will automatically install the drivers and allow you to use it. This is called trust by default and it is what almost all computers do for components that take input from a human. The problem here is an attacker could create a usb device that emumates a keyboard or mouse which when plugged in could type extreamly fast and exectute an arbatrary program. It could type much faster than any human could and could do things like open a cmd and download malware from the internet or basically anything else you can do with a keyboard on your computer. Which by the way is anything, you actually dont need a mouse its just convienient for a human operator. 

## CVSS Version 2.0 Scores
The voulnerability was discovered in 2011 and to my knowlege has not been patched to this day. Which i think is crazy considering all it would take is an option to require your password or something when entering a new usb device. The voulnerability got a base score of 6.9/10, an impact subscore of 10/10 and an exploitability subscore of 3.4/10.

### Impact Subscore
The reason for such a high impact score is the voulnerability impacts confidentiality, integrity and availability completely. Confidentiality is completely broken because a keyboard, which is your main HID to a computer has access to all the system data since the computer by default trusts that it is a human operator using it. The integrity of the system is also completely compromised as the attacker could do things like shut down your virus protection or install backdoors within seconds of the BadUSB being plugged in. [Here](https://samy.pl/usbdriveby/) you can see an example of a BadUSB attack against Mac OS X that will install a permanent backdoor, disable the firewall, and control the flow of network traffic. The worst part is all this happens within a few seconds and is totally permanent even after the usb has been removed. This attack could even do things like completely destroying a locked or unlocked system making it completely unavailable. An example of this attack is called [USB Killer](https://www.bleepingcomputer.com/news/security/shocking-usb-killer-uses-electrical-charge-to-fry-vulnerable-devices/). In this attack a specially crafted usb is plugged in and it collects power from usb power lanes (5V, 1-3A) until it is all the way charged up (240V). Then it discharges this stored voltage very quickly in an attempt to fry the computers circutry. It continues this charge/discharge cycle until it or the computers circutry are damaged or completely destroyed. Whats worse is the researchers that discovered this noted that it effected 95% of devices with the only device that withstood it being a new MacBook since it isolated the data lanes in the usb port.

### Exploitability Subscore
The exploitability subscore was lower at only 3.4/10 and this is mainly due to the fact that the access vector is local meaning you need physical access to the device (to plug in the usb). The access complexity was medium and i would attribute this to the fact that you do need to know some stuff about your target system first before deploying the attack. Things you would need to know would be the operating system definitly since different operating systems have different keys for different things such as windows having the windows key. Also different operating systems require different sequences of keystrokes to access different areas of the computer such as windows key + r opens the run dialog on windows systems but wouldnt do that on Linux of Mac OS X. Finally, the exploit requires no authentication to work and this is why it is so devistating. The trust by default characteristic employed by computers on HID devices is the voulnerability that this attack exploits making it require no authentication. However, i would like to note that the most devistating attacks (except USB Killer) do require the device to be unlocked although several still do not. So i would say that while the exploit, being that computers just trust the usb by default requires no authentication but, many of the attacks that can be built ontop of this voulnerability do require the device to be unlocked.

## BadUSB Windows Keylogger
For the demo portion of this presentation i will be showing how this voulnerability can be used to deliver a simple but devistating keylogger to a fully up to date Windows 10 system. 

### Hardware
For this attack i will be using a [USB rubber ducky](https://shop.hak5.org/products/usb-rubber-ducky-deluxe) which i purchaced from the [Hak5 store](https://shop.hak5.org/) several years ago for about $50. I would highly reccomend checking them out as they have some really cool hacking hardware on their site. This attack could also be carried out by another BadUSB configuration that is much cheaper but this is just what i had on hand. [Here](https://medium.com/@EatonChips/building-a-usb-rubber-ducky-for-7-c851aae30a1d) is a really cool tutorial that shows you how to make a BadUSB out of a $7 Arduino usb microcontroller. I have not actually tried this yet so i cant say if it works but i plan to try it in the future. 
<p align="center">
  <img src="https://github.com/svecile/BadUSB_Notes/blob/main/IMG_3324.jpg" alt="usbInners" width="100"/>
  <img src="https://github.com/svecile/BadUSB_Notes/blob/main/IMG_3325.jpg" alt="usb" width="150"/>
</p>
